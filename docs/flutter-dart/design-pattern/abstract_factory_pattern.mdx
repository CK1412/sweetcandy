---
sidebar_position: 3
title: Abstract Factory
---

# Abstract Factory Pattern

## Abstract Factory Pattern l√† g√¨?

Abstract Factory l√† m·ªôt m·∫´u thi·∫øt k·∫ø ph√©p b·∫°n t·∫°o ra c√°c nh√≥m ƒë·ªëi t∆∞·ª£ng li√™n quan m√† kh√¥ng c·∫ßn ch·ªâ ƒë·ªãnh c√°c l·ªõp c·ª• th·ªÉ c·ªßa ch√∫ng.

## ·ª®ng d·ª•ng
- S·ª≠ d·ª•ng Abstract Factory khi m√£ c·ªßa b·∫°n c·∫ßn ho·∫°t ƒë·ªông v·ªõi nhi·ªÅu l·ªõp li√™n quan kh√°c nhau, nh∆∞ng b·∫°n kh√¥ng mu·ªën 
n√≥ ph·ª• thu·ªôc v√†o c√°c l·ªõp c·ª• th·ªÉ ƒë√≥ - ch√∫ng c√≥ th·ªÉ ch∆∞a ƒë∆∞·ª£c bi·∫øt tr∆∞·ªõc ho·∫∑c b·∫°n ch·ªâ mu·ªën cho ph√©p **kh·∫£ nƒÉng m·ªü r·ªông** trong t∆∞∆°ng lai.

## S∆° ƒë·ªì minh ho·∫°

```mermaid
---
title: Relationships diagram
---
classDiagram
    direction TB

    note for Animal "L·ªõp Dog v√† Cat ƒë·ªÅu ph·∫£i tri·ªÉn khai giao di·ªán Animal, 
        giao di·ªán n√†y khai b√°o m·ªôt ph∆∞∆°ng th·ª©c c√≥ t√™n l√† `sound`.
        M·ªói l·ªõp th·ª±c hi·ªán ph∆∞∆°ng th·ª©c n√†y m·ªôt c√°ch kh√°c nhau."
    Animal <|-- Cat
    Animal <|-- Dog
    class Animal
    <<interface>> Animal
    Animal : ...
    Animal : +sound()
    note for Dog "Ch√≥ (Dog) s·ªßa woof woof"
    class Dog{
        +...
        +sound() 
    }
    note for Cat "M√®o (Cat) k√™u Meow Meow."
    class Cat{
        +...
        +sound()
    }

    AnimalFactory <|.. AnimalFactoryImpl : implements
    note for AnimalFactory "AnimalFactory interface khai b√°o m·ªôt t·∫≠p h·ª£p c√°c ph∆∞∆°ng th·ª©c ƒë·ªÉ t·∫°o t·ª´ng Abstract Animal.
        AnimalFactoryImpl tri·ªÉn khai c√°c ph∆∞∆°ng th·ª©c t·∫°o c·ªßa AnimalFactory."
    
    class AnimalFactory
    <<interface>> AnimalFactory
    AnimalFactory : +createCat() Cat
    AnimalFactory : +createDog() Dog  

    class AnimalFactoryImpl
    AnimalFactoryImpl : +createCat() Cat
    AnimalFactoryImpl : +createDog() Dog
```

## Code tri·ªÉn khai

### Example in Dart

```dart title="Abstract Factory Method example in Dart"
abstract class Animal {
  void sound() {}
}

class Cat implements Animal {
  @override
  void sound() {
    print('üò∫ Cat call Meow Meow Meow');
  }
}

class Dog implements Animal {
  @override
  void sound() {
    print('üê∂ Dog call Woof woof woof');
  }
}

/// Implement Abstract Factory  
///
abstract class AnimalFactory {
  Cat createCat();
  Dog createDog();
}

class AnimalFactoryImpl implements AnimalFactory {
  @override
  Cat createCat() => Cat();

  @override
  Dog createDog() => Dog();
}

void main(List<String> args) {
  final AnimalFactory animalFactory = AnimalFactoryImpl();
  final Animal dog = animalFactory.createDog();
  final Animal cat = animalFactory.createCat();

  assert(cat is Cat);
  cat.sound(); // üò∫ Cat call Meow Meow Meow

  assert(dog is Dog);
  dog.sound(); // üê∂ Dog call Woof woof woof
}
```

### Example in Flutter

ƒêo·∫°n m√£ d∆∞·ªõi ƒë√¢y s·∫Ω m·ªü r·ªông [v√≠ d·ª• tr∆∞·ªõc ƒë√≥](../design-pattern/factory_method_pattern.mdx#example-in-flutter) c·ªßa *Pactory Method Pattern* theo Abstract Factory Method.

```dart title="Abstract Factory Method example in Flutter"
import 'package:flutter/cupertino.dart';
import 'package:flutter/material.dart';

abstract class PlatformFilledButton {
  // ...
}

class MaterialFilledButton implements PlatformFilledButton {
  // ...
}

class CupertinoFilledButton implements PlatformFilledButton {
  /// ...
}

abstract class PlatformSwitch {
  factory PlatformSwitch(TargetPlatform platform) {
    return switch (platform) {
      TargetPlatform.android ||
      TargetPlatform.fuchsia ||
      TargetPlatform.linux ||
      TargetPlatform.windows =>
        MaterialSwitch(),
      TargetPlatform.iOS || TargetPlatform.macOS => MyCupertinoSwitch(),
    };
  }

  Widget build(
    BuildContext context, {
    required bool value,
    required ValueChanged<bool> onChanged,
  });
}

class MaterialSwitch implements PlatformSwitch {
  @override
  Widget build(
    BuildContext context, {
    required bool value,
    required ValueChanged<bool> onChanged,
  }) {
    return Switch(
      value: value,
      onChanged: onChanged,
    );
  }
}

class MyCupertinoSwitch implements PlatformSwitch {
  @override
  Widget build(
    BuildContext context, {
    required bool value,
    required ValueChanged<bool> onChanged,
  }) {
    return CupertinoSwitch(
      value: value,
      onChanged: onChanged,
    );
  }
}

/// Implement Abstract Factory Method
///
class PlatformWidget {
  static Widget buildFilledButton(
    BuildContext context, {
    required Widget child,
    required VoidCallback onPressed,
  }) {
    return PlatformFilledButton(Theme.of(context).platform).build(
      context,
      child: child,
      onPressed: onPressed,
    );
  }

  static Widget buildSwitch(
    BuildContext context, {
    required bool value,
    required ValueChanged<bool> onChanged,
  }) {
    return PlatformSwitch(Theme.of(context).platform).build(
      context,
      value: value,
      onChanged: onChanged,
    );
  }
}

void main(List<String> args) {
  runApp(const MyAppScreen());
}

class MyAppScreen extends StatefulWidget {
  const MyAppScreen({super.key});

  @override
  State<MyAppScreen> createState() => _MyAppScreenState();
}

class _MyAppScreenState extends State<MyAppScreen> {
  bool _value = true;

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        body: Center(
          child: PlatformWidget.buildSwitch(
            context,
            value: _value,
            onChanged: (value) {
              setState(() {
                _value = value;
              });
            },
          ),
        ),
      ),
    );
  }
}
```

Qua v√≠ d·ª• n√†y, ch√∫ng ta c√≥ th·ªÉ th·∫•y Abstract Factory Method pattern c√≥ m·ªôt s·ªë ∆∞u ƒëi·ªÉm so v·ªõi Factory Method pattern,
cho ph√©p vi·∫øt client code r√µ r√†ng m√† kh√¥ng c·∫ßn bi·∫øt subclass c·ªßa platform n√†o s·∫Ω ƒë∆∞·ª£c t·∫°o.

## T√†i li·ªáu tham kh·∫£o

- https://refactoring.guru/design-patterns/abstract-factory
- https://anonystick.com/blog-developer/phan-2-factory-pattern-cach-ma-toi-trien-khai-trong-nha-may-vinfast-fresher-va-junior-nen-bo-qua-phan-3-2020110554662242