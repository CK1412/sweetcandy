---
sidebar_position: 2
title: Factory Method
---

# Factory Method Pattern

> C√≤n ƒë∆∞·ª£c g·ªçi l√† *Virtual Constructor*.

## Factory Method l√† g√¨?

Factory Method l√† m·ªôt m·∫´u thi·∫øt k·∫ø cho ch√∫ng ta ƒë·ªãnh nghƒ©a ƒë∆∞·ª£c nhi·ªÅu ƒë·ªëi t∆∞·ª£ng v√† cho ph√©p c√°c l·ªõp con t·ª± quy·∫øt ƒë·ªãnh 
l√† c√°i n√†o ƒë∆∞·ª£c kh·ªüi t·∫°o, gi√∫p che gi·∫•u logic t·∫°o c·ªßa ƒë·ªëi t∆∞·ª£ng kh·ªèi client code.

## S∆° ƒë·ªì minh ho·∫°

```mermaid
---
title: Relationships diagram
---
classDiagram
    note "L·ªõp Dog v√† Cat ƒë·ªÅu ph·∫£i tri·ªÉn khai giao di·ªán Animal, \ngiao di·ªán n√†y khai b√°o m·ªôt ph∆∞∆°ng th·ª©c c√≥ t√™n l√† `sound`.
          M·ªói l·ªõp th·ª±c hi·ªán ph∆∞∆°ng th·ª©c n√†y m·ªôt c√°ch kh√°c nhau: \nCh√≥ (Dog) s·ªßa woof woof, M√®o (Cat) k√™u Meow Meow."
    class Animal
    <<interface>> Animal
    Animal <|-- Cat
    Animal <|-- Dog
    Animal : ...
    Animal : +sound()
    class Dog{
      +...
      +sound()
    }
    class Cat{
      +...
      +sound()
    }
```

## Code tri·ªÉn khai

### Example in Dart

```dart title="Factory Method Pattern example in Dart"
abstract class Animal {
  factory Animal(AnimalSpecies species) {
    return switch (species) {
      AnimalSpecies.cat => Cat(),
      AnimalSpecies.dog => Dog(),
    };
  }
  void sound() {}
}

class Cat implements Animal {
  @override
  void sound() {
    print('üò∫ Cat call Meow Meow Meow');
  }
}

class Dog implements Animal {
  @override
  void sound() {
    print('üê∂ Dog call Woof woof woof');
  }
}

enum AnimalSpecies {
  dog,
  cat,
}

void main(List<String> args) {
  final Animal cat = Animal(AnimalSpecies.cat);
  final Animal dog = Animal(AnimalSpecies.dog);

  assert(cat is Cat);
  cat.sound(); // üò∫ Cat call Meow Meow Meow

  assert(dog is Dog);
  dog.sound(); // üê∂ Dog call Woof woof woof
}
```

### Example in Flutter {#example-in-flutter}

Trong v√≠ d·ª• n√†y, Factory Method ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ t·∫°o m·ªôt FilledButton hi·ªÉn th·ªã theo n·ªÅn t·∫£ng. 

:::info

ƒê√¢y ch·ªâ l√† v√≠ d·ª• v·ªÅ c√°ch tri·ªÉn khai Factory Method, trong th·ª±c t·∫ø t√¥i s·∫Ω d√πng c√°ch kh√°c ng·∫Øn h∆°n v·ªõi tr∆∞·ªùng h·ª£p n√†y.

:::

```dart title="Factory Method Pattern example in Flutter"
import 'package:flutter/cupertino.dart';
import 'package:flutter/material.dart';

abstract class PlatformFilledButton {
  factory PlatformFilledButton(TargetPlatform platform) {
    return switch (platform) {
      TargetPlatform.android ||
      TargetPlatform.fuchsia ||
      TargetPlatform.linux ||
      TargetPlatform.windows =>
        MaterialFilledButton(),
      TargetPlatform.iOS || TargetPlatform.macOS => CupertinoFilledButton(),
    };
  }

  Widget build(
    BuildContext context, {
    required Widget child,
    required VoidCallback onPressed,
  });
}

class MaterialFilledButton implements PlatformFilledButton {
  @override
  Widget build(
    BuildContext context, {
    required Widget child,
    required VoidCallback onPressed,
  }) {
    return FilledButton(
      onPressed: onPressed,
      child: child,
    );
  }
}

class CupertinoFilledButton implements PlatformFilledButton {
  @override
  Widget build(
    BuildContext context, {
    required Widget child,
    required VoidCallback onPressed,
  }) {
    return CupertinoButton.filled(
      onPressed: onPressed,
      child: child,
    );
  }
}

void main(List<String> args) {
  runApp(const MyAppScreen());
}

class MyAppScreen extends StatelessWidget {
  const MyAppScreen({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        body: Center(
          child: PlatformFilledButton(Theme.of(context).platform).build(
            context,
            onPressed: () {
              debugPrint('Button pressed!');
            },
            child: const Text('Click me!'),
          ),
        ),
      ),
    );
  }
}
```

## T√†i li·ªáu tham kh·∫£o
- https://refactoring.guru/design-patterns/factory-method
- https://dart.academy/creational-design-patterns-for-dart-and-flutter-factory-method/